{"version":3,"sources":["../../src/index.js","simple-example.js","debouncing-example.js","async-example.js","initializing-example.js","App.js","index.js"],"names":["lastCall","timeout","cancel","useEffect","clearTimeout","Promise","stillValid","dontReject","catchCancel","reject","message","timestamp","Date","setTimeout","a","originalFunction","result","resolve","delay","preventReject","SimpleExample","divRef","useRef","useDelayedFunction","target","content","innerHTML","changeContentLater","current","className","ref","href","DebouncingExample","defaultDelay","contentRef","useState","setDelay","debounceChange","removeStyleLater","addStyleNow","type","placeholder","onChange","e","value","then","htmlFor","id","name","min","max","step","AsyncExample","startButton","setStartButton","errState","setErrState","content1","content2","addContent","cancelAddContent","showContent","onClick","catch","err","InitializingExample","App","example","setExample","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.709e14c5.chunk.js","sourcesContent":["import { useEffect, useRef } from 'react'\n\nexport default function useDelayedFunction(\n  originalFunction,\n  delay,\n  catchCancel\n) {\n  const lastCall = useRef({ timeout: null, cancel: null }).current\n  function delayedFunction() {\n    if (lastCall.cancel) {\n      lastCall.cancel()\n      lastCall.cancel = null\n    }\n    if (lastCall.timeout) {\n      clearTimeout(lastCall.timeout)\n      lastCall.timeout = null\n    }\n    return new Promise((resolve, reject) => {\n      let stillValid = true\n      lastCall.cancel = (dontReject) => {\n        stillValid = false\n        if (catchCancel && !dontReject) {\n          reject({ message: 'Function call canceled', timestamp: Date.now() })\n        }\n      }\n      lastCall.timeout = setTimeout(async () => {\n        lastCall.timeout = null\n        try {\n          const result = await (originalFunction &&\n            originalFunction(...arguments))\n          lastCall.cancel = null\n          if (stillValid) {\n            resolve(result)\n          }\n        } catch (err) {\n          lastCall.cancel = null\n          if (stillValid) {\n            reject(err)\n          }\n        }\n      }, delay || 0)\n    })\n  }\n\n  const cancelIt = (preventReject) => {\n    if (lastCall.cancel) {\n      lastCall.cancel(preventReject)\n      lastCall.cancel = null\n    }\n    if (lastCall.timeout) {\n      clearTimeout(lastCall.timeout)\n      lastCall.timeout = null\n    }\n  }\n\n  useEffect(() => {\n    return () => {\n      if (lastCall.cancel) {\n        lastCall.cancel(true)\n      }\n      if (lastCall.timeout) {\n        clearTimeout(lastCall.timeout)\n      }\n    }\n  }, [])\n\n  return [delayedFunction, cancelIt]\n}\n","import React, { useRef, useEffect } from 'react'\n\nimport useDelayedFunction from 'use-delayed-function'\n\nconst SimpleExample = ({ delay = 4000 }) => {\n  const divRef = useRef()\n\n  const [changeContentLater] = useDelayedFunction(changeContent, delay)\n\n  function changeContent(target, content) {\n    target.innerHTML = content\n  }\n\n  useEffect(() => {\n    changeContentLater(divRef.current, 'This is the new content')\n  }, [])\n\n  return (\n    <div className='container simple-example'>\n      <p ref={divRef}>{`This content will change ${delay}ms after mounting`}</p>\n      <div className='links'>\n        <a href='https://github.com/makannew/use-delayed-function/blob/master/example/src/simple-example.js'>\n          Source code\n        </a>\n        <a href='https://github.com/makannew/use-delayed-function'>\n          use-delayed-function\n        </a>\n      </div>\n    </div>\n  )\n}\n\nexport default SimpleExample\n","import React, { useState, useRef } from 'react'\nimport useDelayedFunction from 'use-delayed-function'\n\nconst DebouncingExample = ({ defaultDelay = 900 }) => {\n  const contentRef = useRef()\n  const [delay, setDelay] = useState(defaultDelay)\n\n  const [debounceChange] = useDelayedFunction(changeContent, delay)\n\n  const [removeStyleLater] = useDelayedFunction(removeStyle, 1000)\n\n  const [addStyleNow] = useDelayedFunction(addStyle)\n\n  function changeContent(target, content) {\n    target.innerHTML = content\n    return target\n  }\n\n  function addStyle(target) {\n    target.className = 'updating'\n    return target\n  }\n\n  function removeStyle(target) {\n    target.className = ''\n  }\n\n  function handleChange(e) {\n    debounceChange(contentRef.current, e.target.value)\n      .then(addStyleNow)\n      .then(removeStyleLater)\n  }\n\n  return (\n    <div>\n      <div className='description'>\n        <h3>Stateless debouncing</h3>\n        <p>\n          While typing debounced result will be updated. Try it by typing in\n          textarea.\n        </p>\n      </div>\n\n      <div className='container'>\n        <div className='form-container'>\n          <form>\n            <h4>Real-time value</h4>\n\n            <textarea\n              type='text'\n              placeholder='Type something'\n              onChange={handleChange}\n            />\n            <label htmlFor='delay'>{`Debouncing delay ${delay}ms`}</label>\n            <input\n              type='range'\n              id='delay'\n              name='delay'\n              value={delay}\n              min={0}\n              max={2000}\n              step={20}\n              onChange={(e) => {\n                setDelay(e.target.value)\n              }}\n            />\n          </form>\n        </div>\n        <div className='form-container'>\n          <form>\n            <h4>Debounced result</h4>\n            <p ref={contentRef}></p>\n          </form>\n        </div>\n      </div>\n      <div className='links'>\n        <a href='https://github.com/makannew/use-delayed-function/blob/master/example/src/debouncing-example.js'>\n          Source code\n        </a>\n        <a href='https://github.com/makannew/use-delayed-function'>\n          use-delayed-function\n        </a>\n      </div>\n    </div>\n  )\n}\n\nexport default DebouncingExample\n","import React, { useState, useRef } from 'react'\nimport useDelayedFunction from 'use-delayed-function'\n\nconst AsyncExample = () => {\n  const divRef = useRef()\n  const [startButton, setStartButton] = useState(true)\n  const [errState, setErrState] = useState(false)\n\n  const [addContent, cancelAddContent] = useDelayedFunction(\n    addContentAsync,\n    0,\n    true\n  )\n\n  function addContentAsync(content1, content2) {\n    return new Promise((resolve, reject) => {\n      setTimeout(() => {\n        resolve(content1 + content2)\n      }, 2000)\n    })\n  }\n\n  function showContent(target, content) {\n    target.innerHTML = content\n  }\n\n  function handleClick() {\n    if (startButton) {\n      setStartButton(false)\n      setErrState(false)\n      showContent(divRef.current, 'adding content will be started soon')\n      addContent('Hello', ' ')\n        .then((result) => {\n          showContent(divRef.current, result)\n          return addContent(result, 'world')\n        })\n        .then((result) => {\n          showContent(divRef.current, result)\n          setStartButton(true)\n        })\n        .catch((err) => {\n          setErrState(err)\n        })\n    } else {\n      cancelAddContent()\n      setStartButton(true)\n      showContent(divRef.current, 'click to start async adding of content')\n    }\n  }\n\n  return (\n    <div>\n      <div className='container async-example'>\n        <p ref={divRef}>click to start async adding of content</p>\n        <button onClick={handleClick} className={startButton ? '' : 'red'}>\n          {startButton ? 'Start' : 'Stop'}\n        </button>\n        <p className='error'>\n          {errState\n            ? `${errState.message} @timestamp:${errState.timestamp}`\n            : null}\n        </p>\n      </div>\n      <div className='links'>\n        <a href='https://github.com/makannew/use-delayed-function/blob/master/example/src/async-example.js'>\n          Source code\n        </a>\n        <a href='https://github.com/makannew/use-delayed-function'>\n          use-delayed-function\n        </a>\n      </div>\n    </div>\n  )\n}\n\nexport default AsyncExample\n","import React, { useState, useRef, useEffect } from 'react'\n\nimport useDelayedFunction from 'use-delayed-function'\n\nconst InitializingExample = () => {\n  const divRef = useRef()\n\n  function initialize() {}\n  useEffect(() => {}, [])\n\n  return (\n    <div ref={divRef} className='container initializing-example'>\n      <p>{`Loading`}</p>\n      <div className='links'>\n        <a href='https://github.com/makannew/use-delayed-function/blob/master/example/src/initializing-example.js'>\n          Source code\n        </a>\n        <a href='https://github.com/makannew/use-delayed-function'>\n          use-delayed-function\n        </a>\n      </div>\n    </div>\n  )\n}\n\nexport default InitializingExample\n","/*\n * Example to show usage of use-delayed-function\n *\n * @link https://github.com/makannew/use-delayed-function\n * @file index.js\n * @author Makan Edrisi\n * @since 2020\n *\n */\nimport React, { useState } from 'react'\nimport SimpleExample from './simple-example'\nimport DebouncingExample from './debouncing-example'\nimport AsyncExample from './async-example'\nimport InitializingExample from './initializing-example'\n\nconst App = () => {\n  const [example, setExample] = useState(1)\n\n  return (\n    <>\n      {example === 1 ? <SimpleExample /> : null}\n      {example === 2 ? <DebouncingExample /> : null}\n      {example === 3 ? <AsyncExample /> : null}\n      {example === 4 ? <InitializingExample /> : null}\n\n      <div className='buttons'>\n        <button onClick={() => setExample(1)}>\n          Simple Example of 'use-delayed-function'\n        </button>\n        <button onClick={() => setExample(2)}>Debouncing Example</button>\n        <button onClick={() => setExample(3)}>\n          Async and side effect example\n        </button>\n        <button onClick={() => setExample(4)}>Initializing example</button>\n      </div>\n    </>\n  )\n}\n\nexport default App\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}